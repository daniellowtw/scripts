# Linux setup commands

# List all available recipes (default)
default:
    @just --list

# Install Pi-hole (network-wide ad blocker)
install-pihole:
    @echo "Installing Pi-hole..."
    @echo "This will make significant system changes (DNS server, web server, etc.)"
    curl -sSL https://install.pi-hole.net | bash

# Install Tailscale (mesh VPN)
install-tailscale:
    @echo "Installing Tailscale..."
    @echo "Adding Tailscale repository and signing key..."
    curl -fsSL https://pkgs.tailscale.com/stable/debian/trixie.noarmor.gpg | sudo tee /usr/share/keyrings/tailscale-archive-keyring.gpg >/dev/null
    curl -fsSL https://pkgs.tailscale.com/stable/debian/trixie.tailscale-keyring.list | sudo tee /etc/apt/sources.list.d/tailscale.list
    @echo "Updating package list and installing Tailscale..."
    sudo apt-get update
    sudo apt-get install -y tailscale
    @echo "Tailscale installed successfully!"
    @echo "Run 'sudo tailscale up' to connect to your network"
    @echo "Run 'tailscale ip -4' to see your Tailscale IP address"

install-claude:
    curl -fsSL https://claude.ai/install.sh | bash

install-go:
    #!/usr/bin/env bash
    set -euo pipefail
    echo "Installing Go using official installer..."
    echo "Detecting architecture..."
    ARCH=$(uname -m)
    if [ "$ARCH" = "arm64" ]; then
        GO_PKG="go1.23.4.darwin-arm64.pkg"
    else
        GO_PKG="go1.23.4.darwin-amd64.pkg"
    fi
    echo "Downloading Go for $ARCH..."
    curl -LO "https://go.dev/dl/$GO_PKG"
    echo "Installing Go..."
    sudo installer -pkg "$GO_PKG" -target /
    rm "$GO_PKG"
    echo "Go installed successfully to /usr/local/go!"
    echo "Run 'go version' to verify installation"
    echo "Note: /usr/local/go/bin should be in your PATH"

install-node:
    #!/usr/bin/env bash
    # Download and install nvm:
    curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash

    # in lieu of restarting the shell
    \. "$HOME/.nvm/nvm.sh"

    # Download and install Node.js:
    nvm install 24

    # Verify the Node.js version:
    node -v # Should print "v24.12.0".

    # Verify npm version:
    npm -v # Should print "11.6.2".

install-tools:
    brew install fzf jq ripgrep direnv uv neovim ncdu tig entr

install-rust-tools:
    cargo install starship xplr zoxide

[working-directory('../dotfiles/')]
setup:
    bash ./set-up-vim.sh || true
    defaults write com.microsoft.VSCode ApplePressAndHoldEnabled -bool false
    defaults write com.microsoft.VSCodeInsiders ApplePressAndHoldEnabled -bool false
    defaults write com.vscodium ApplePressAndHoldEnabled -bool false
    defaults write com.microsoft.VSCodeExploration ApplePressAndHoldEnabled -bool false
    defaults write com.exafunction.windsurf ApplePressAndHoldEnabled -bool false
    defaults delete -g ApplePressAndHoldEnabled

install: install-tools install-rust-tools

install-codium:
    brew install --cask vscodium

install-office:
    open https://www.libreoffice.org/download/download-libreoffice/
